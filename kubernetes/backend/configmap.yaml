apiVersion: v1
kind: ConfigMap
metadata:
  name: backend-config
  namespace: personal-diary
  labels:
    app.kubernetes.io/name: personal-diary
    app.kubernetes.io/component: backend
data:
  APP_NAME: "Personal Diary API"
  APP_ENV: "production"
  DEBUG: "false"
  API_V1_PREFIX: "/api/v1"
  HOST: "0.0.0.0"
  PORT: "8000"

  # Database
  DATABASE_URL: "postgresql+asyncpg://diary_user:diary_password@postgres-service.personal-diary.svc.cluster.local:5432/personal_diary"
  DATABASE_POOL_SIZE: "10"
  DATABASE_MAX_OVERFLOW: "20"

  # Redis
  REDIS_URL: "redis://redis-service.personal-diary.svc.cluster.local:6379/0"

  # Celery
  CELERY_BROKER_URL: "redis://redis-service.personal-diary.svc.cluster.local:6379/1"
  CELERY_RESULT_BACKEND: "redis://redis-service.personal-diary.svc.cluster.local:6379/2"

  # Security
  ALGORITHM: "HS256"
  ACCESS_TOKEN_EXPIRE_MINUTES: "15"
  REFRESH_TOKEN_EXPIRE_DAYS: "30"

  # Encryption
  ENCRYPTION_KEY_ALGORITHM: "X25519"
  SYMMETRIC_CIPHER_ALGORITHM: "ChaCha20-Poly1305"
  KEY_DERIVATION_ALGORITHM: "Argon2id"
  ARGON2_TIME_COST: "2"
  ARGON2_MEMORY_COST: "65536"
  ARGON2_PARALLELISM: "1"

  # Storage Limits
  FREE_TIER_STORAGE_BYTES: "1073741824"  # 1GB
  PAID_TIER_STORAGE_BYTES: "53687091200"  # 50GB
  MAX_FILE_SIZE_BYTES: "52428800"  # 50MB

  # Rate Limiting
  RATE_LIMIT_AUTH_PER_MINUTE: "5"
  RATE_LIMIT_API_PER_MINUTE: "100"
  RATE_LIMIT_MEDIA_PER_MINUTE: "10"

  # CORS
  CORS_ORIGINS: "http://localhost:3000,https://diary.xmojo.net"
  CORS_CREDENTIALS: "true"
  CORS_METHODS: "*"
  CORS_HEADERS: "*"

  # Logging
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"

  # AWS Region
  AWS_REGION: "us-east-1"
